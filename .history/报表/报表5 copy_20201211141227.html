<html>

<head>

    <meta charset="utf-8">
    <title>报表</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@4.9.0/dist/echarts.min.js"></script>

</head>

<body>

    <div id="chartmain" style="width:100%; height: 500px;"></div>

    <script type="text/javascript">
        appl1 = []
        iosl2 = []
        datalist = [
            [3, '9.88.1', 48002],
            [3, '9.73.2', 38256],
            [1, '9.73.0', 32221],
            [1, '9.73.1', 16895],
            [3, '9.72.2', 16075],
            [1, '9.72.1', 7284],
            [1, '9.72.0', 4058],
            [3, '9.72.4', 3122],
            [3, '9.72.1', 3091],
            [1, '9.71.1', 2052],
            [3, '9.71.1', 1836],
            [3, '9.70.4', 1370],
            [1, '9.71.2', 954],
            [1, '9.70.1', 721],
            [1, '9.69.0', 648],
            [1, '9.70.2', 619],
            [3, '9.70.1', 581],
            [3, '9.56.1', 570],
            [1, '9.66.1', 532],
            [3, '9.63.2', 479],
            [1, '9.66.2', 476],
            [3, '9.73.0', 475],
            [3, '9.69.2', 469],
            [3, '9.68.2', 444],
            [3, '9.71.2', 442],
            [1, '9.65.2', 437],
            [1, '9.61.0', 419],
            [3, '9.69.1', 410],
            [3, '9.67.1', 375],
            [1, '9.67.0', 365],
            [1, '9.68.0', 356],
            [1, '9.69.1', 355],
            [1, '9.59.2', 341],
            [1, '9.70.0', 330],
            [3, '9.64.2', 308],
            [3, '9.66.1', 303],
            [3, '9.71.4', 296],
            [1, '9.67.1', 294],
            [1, '9.62.0', 283],
            [1, '9.64.0', 275],
            [3, '9.64.1', 259],
            [3, '9.60.2', 251],
            [1, '9.60.4', 251],
            [3, '9.72.0', 249],
            [1, '9.63.2', 235],
            [1, '9.71.6', 228],
            [3, '9.65.2', 224],
            [1, '9.61.1', 206],
            [3, '9.65.1', 196],
            [1, '9.64.1', 191],
            [3, '9.63.1', 187],
            [1, '9.65.1', 180],
            [3, '9.67.2', 162],
            [1, '9.60.0', 140],
            [3, '9.61.1', 131],
            [1, '9.58.0', 130],
            [1, '9.57.0', 126],
            [3, '9.66.4', 118],
            [1, '9.52.2', 105],
            [1, '9.63.1', 103],
            [3, '9.60.1', 101],
            [1, '9.58.1', 92],
            [1, '9.63.0', 86],
            [1, '9.60.1', 86],
            [1, '9.51.2', 85],
            [3, '9.58.2', 83],
            [3, '9.46.2', 81],
            [3, '9.59.1', 80],
            [1, '9.62.1', 80],
            [3, '9.62.1', 75],
            [1, '9.65.0', 74],
            [1, '9.58.3', 74],
            [1, '9.56.0', 74],
            [1, '9.49.4', 73],
            [1, '9.50.2', 71],
            [3, '9.52.4', 64],
            [3, '9.62.2', 63],
            [1, '9.53.4', 63],
            [1, '9.47.0', 62],
            [3, '9.69.0', 62],
            [3, '9.68.0', 58],
            [1, '9.54.2', 58],
            [3, '9.57.1', 57],
            [3, '9.58.3', 56],
            [3, '9.54.2', 53],
            [3, '9.51.2', 51],
            [3, '9.70.2', 50],
            [3, '9.48.5', 44],
            [1, '9.55.4', 44],
            [3, '9.58.1', 44],
            [3, '9.57.2', 41],
            [3, '9.49.4', 39],
            [1, '9.56.1', 39],
            [1, '9.71.0', 38],
            [3, '9.67.0', 38],
            [3, '9.66.2', 38],
            [3, '9.50.4', 37],
            [3, '9.55.6', 36],
            [1, '9.57.1', 36],
            [1, '9.59.1', 35]
        ].slice(0, 10)
        //初始化echarts实例
        var appqudao = datalist.map(function (item) {
            if (item[0] == 3) {
                appl1.push(item);

            } else if (item[0] == 1) {
                iosl2.push(item);
            };

        });

        var appbanben = appl1.map(function (item) {
            return item[1];
        });
        var appcn = appl1.map(function (item) {
            return item[2];
        });

        var iosappbanben = iosl2.map(function (item) {
            return item[1];
        });
        var iosappcn = iosl2.map(function (item) {
            return item[2];
        });
        console.log(appbanben)
        console.log(appbanben)
        console.log(appbanben)
        console.log(appcn)


        var appuu= {  "安卓订单占比": "62%", "ios订单占比": "37.88%"  };
        // console.log(appcn)

        // var data = genData(50);
    
    var builderJson = {
            "all": 10887,
            "charts": {
                "map": 3237,
                "lines": 2164,
                "bar": 7561,
                "line": 7778,
                "pie": 7355,
                "scatter": 2405,
                "candlestick": 1842,
                "radar": 2090,
                "heatmap": 1762,
                "treemap": 1593,
                "graph": 2060,
                "boxplot": 1537,
                "parallel": 1908,
                "gauge": 2107,
                "funnel": 1692,
                "sankey": 1568
            },
            "components": {
                "geo": 2788,
                "title": 9575,
                "legend": 9400,
                "tooltip": 9466,
                "grid": 9266,
                "markPoint": 3419,
                "markLine": 2984,
                "timeline": 2739,
                "dataZoom": 2744,
                "visualMap": 2466,
                "toolbox": 3034,
                "polar": 1945
            },
            "ie": 9743
        };

        var downloadJson = {
            "echarts.min.js": 17365,
            "echarts.simple.min.js": 4079,
            "echarts.common.min.js": 6929,
            "echarts.js": 14890
        };

        var themeJson = {
            "dark.js": 1594,
            "infographic.js": 925,
            "shine.js": 1608,
            "roma.js": 721,
            "macarons.js": 2179,
            "vintage.js": 1982
        };

        var waterMarkText = 'ECHARTS';

        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        canvas.width = canvas.height = 100;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.globalAlpha = 0.08;
        ctx.font = '20px Microsoft Yahei';
        ctx.translate(50, 50);
        ctx.rotate(-Math.PI / 4);
        ctx.fillText(waterMarkText, 0, 0);

        option = {
            backgroundColor: {
                type: 'pattern',
                image: canvas,
                repeat: 'repeat'
            },
            tooltip: {},
            title: [{
                text: '在线构建',
                subtext: '总计 ' + builderJson.all,
                left: '25%',
                textAlign: 'center'
            }, {
                text: '各版本下载',
                subtext: '总计 ' + Object.keys(downloadJson).reduce(function (all, key) {
                    return all + downloadJson[key];
                }, 0),
                left: '75%',
                textAlign: 'center'
            }, {
                text: '主题下载',
                subtext: '总计 ' + Object.keys(themeJson).reduce(function (all, key) {
                    return all + themeJson[key];
                }, 0),
                left: '75%',
                top: '50%',
                textAlign: 'center'
            }],
            grid: [{
                top: 50,
                width: '50%',
                bottom: '45%',
                left: 10,
                containLabel: true
            }, {
                top: '55%',
                width: '50%',
                bottom: 0,
                left: 10,
                containLabel: true
            }],
            xAxis: [{
                type: 'value',
                max: builderJson.all,
                splitLine: {
                    show: false
                }
            }, {
                type: 'value',
                max: builderJson.all,
                gridIndex: 1,
                splitLine: {
                    show: false
                }
            }],
            yAxis: [{
                type: 'category',
                data: appbanben,
                axisLabel: {
                    interval: 0,
                    rotate: 30
                },
                splitLine: {
                    show: false
                }
            }, {
                gridIndex: 1,
                type: 'category',
                data: Object.keys(builderJson.components),
                axisLabel: {
                    interval: 0,
                    rotate: 30
                },
                splitLine: {
                    show: false
                }
            }],
            series: [{
                type: 'bar',
                stack: 'chart',
                z: 3,
                label: {
                    normal: {
                        position: 'right',
                        show: true
                    }
                },
                data:appcn
            }, {
                type: 'bar',
                stack: 'chart',
                silent: true,
                itemStyle: {
                    normal: {
                        color: '#eee'
                    }
                },
                data: Object.keys(builderJson.charts).map(function (key) {
                    return builderJson.all - builderJson.charts[key];
                })
            }, {
                type: 'bar',
                stack: 'component',
                xAxisIndex: 1,
                yAxisIndex: 1,
                z: 3,
                label: {
                    normal: {
                        position: 'right',
                        show: true
                    }
                },
                data: Object.keys(builderJson.components).map(function (key) {
                    return builderJson.components[key];
                })
            }, {
                type: 'bar',
                stack: 'component',
                silent: true,
                xAxisIndex: 1,
                yAxisIndex: 1,
                itemStyle: {
                    normal: {
                        color: '#eee'
                    }
                },
                data: Object.keys(builderJson.components).map(function (key) {
                    return builderJson.all - builderJson.components[key];
                })
            }, {
                type: 'pie',
                radius: [0, '30%'],
                center: ['75%', '25%'],
                data: Object.keys(downloadJson).map(function (key) {
                    return {
                        name: key.replace('.js', ''),
                        value: downloadJson[key]
                    }
                })
            }, {
                type: 'pie',
                radius: [0, '30%'],
                center: ['75%', '75%'],
                data: Object.keys(themeJson).map(function (key) {
                    return {
                        name: key.replace('.js', ''),
                        value: themeJson[key]
                    };
                })
            }]
        };
        var myChart = echarts.init(document.getElementById('chartmain'));

        //使用制定的配置项和数据显示图表
        myChart.setOption(option);

    </script>
</body>

</html>